<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
       <!-- ëª¨ë‹¬ì°½ : ì°¸ì—¬ ì‹ ì²­ì— ëŒ€í•œ ì°¸ê°€ ë° ìˆ˜ë½ ê¸°ëŠ¥ (ì‹ ì²­ìì˜ ì •ë³´, ìê¸°ì†Œê°œì„œ, ë“±ë“± ì •ë³´ë¥¼ í™•ì¸) -->
        <div th:fragment="fragment-apply-modal" class="modal fade" id="myModal">
            <div class="modal-dialog">
                <div class="modal-content" style="border-radius: 15px;">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">ğŸ™‹â€â™‚ï¸ ìŠ¤í„°ë”” ì°¸ê°€ì‹ ì²­</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal body -->
                    <div class="modal-body">
                        <div>   <!-- ìŠ¤í„°ë”” ì´ë¦„ -->
                            <label><b>ìŠ¤í„°ë”” ì´ë¦„</b></label>
                            <input type="text" class="form-control" id="studyName" value="" readonly>
                        </div>
                        <br>

                        <div>   <!-- ì‹ ì²­ì ì´ë¦„ -->
                            <label><b>ì‹ ì²­ì ì´ë¦„</b></label>
                            <input type="text" class="form-control" id="applicant_name" value="" readonly>
                        </div>
                        <br>
                        <div>   <!-- ì‹ ì²­ì ìê¸°ì†Œê°œì„œ -->
                            <label><b>ìê¸°ì†Œê°œì„œ</b></label>
                            <textarea type="text" class="form-control" id="applicant_info" rows="5" readonly value=""></textarea>
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button id="apply_accept" type="button" class="btn btn-primary" data-dismiss="modal">ìˆ˜ë½</button>
                        <button id="apply_refuse" type="button" class="btn btn-danger" data-dismiss="modal">ê±°ì ˆ</button>
                    </div>
                    <input type="hidden" id="study_no_modal" value=""/>
                    <input type="hidden" id="apply_no_modal" value=""/>
                    <input type="hidden" id="applicant_email" value=""/>
                </div>
            </div>
            <script type="text/javascript">
                $(function () {
                    /* ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì•Œë¦¼ì— ëŒ€í•œ click ì´ë²¤íŠ¸ ë“±ë¡  */
                    $("#alarm_info").on("click", ".testBtn", function(){
                        console.log("load btn .. ok");
                    });

                    /* ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì•Œë¦¼ divì— ëŒ€í•œ Modalì°½ ì •ë³´ ë¡œë“œ */
                    $(".testBtn").click(function(){
                        console.log("testBtn click ok");
                        $("#studyName").val($(this).find(".study_name").text());
                        $("#applicant_name").val($(this).find(".study_applicant_name").text());
                        $("#applicant_info").val($(this).find(".study_applicant_content").val());
                        $("#study_no_modal").val($(this).find(".study_no").val());
                        $("#apply_no_modal").val($(this).find(".apply_no").val());
                        $("#applicant_email").val($(this).find(".applicant_email").val());
                    });

                    /* ìˆ˜ë½ ë²„íŠ¼ í´ë¦­ì‹œ ì´ë²¤íŠ¸ ë“±ë¡ */
                    $("#apply_accept").click(function(){
                        console.log("ì‹ ì²­ ìˆ˜ë½ ë²„íŠ¼ í´ë¦­");
                        if(!confirm("'"+$("#applicant_name").val()+"' ë‹˜ì˜ '"+$("#studyName").val()+"' ìŠ¤í„°ë”” ì°¸ê°€ì‹ ì²­ì„ ìˆ˜ë½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
                            return;
                        }
                       var param = {
                            email: $("#applicant_email").val(),
                            study_no : $("#study_no_modal").val(),
                            apply_no : $("#apply_no_modal").val()
                       };
                        $.ajax({
                            type: "post",
                            url: "/apply/accept",
                            data: JSON.stringify(param),
                            contentType: "application/json; charset=utf-8",
                            success: function () {
                                alert("ì°¸ê°€ ì‹ ì²­ì„ ìˆ˜ë½í•˜ì˜€ìŠµë‹ˆë‹¤.");
                                location.href = "/requestedApply";
                            }
                        });
                    });

                    /* ê±°ì ˆ ë²„íŠ¼ í´ë¦­ì‹œ ì´ë²¤íŠ¸ ë“±ë¡ */
                    $("#apply_refuse").click(function(){
                        console.log("ì‹ ì²­ ê±°ì ˆ ë²„íŠ¼ í´ë¦­");
                        if(!confirm("'"+$("#applicant_name").val()+"' ë‹˜ì˜ '"+$("#studyName").val()+"' ìŠ¤í„°ë”” ì°¸ê°€ì‹ ì²­ì„ ê±°ì ˆí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
                            return;
                        }
                        var apply_no = $("#apply_no_modal").val();
                        $.ajax({
                            type: "post",
                            url: "/apply/refuse",
                            data: "applyNo=" + apply_no,
                            success: function () {
                                alert("ì°¸ê°€ ì‹ ì²­ì„ ê±°ì ˆí•˜ì˜€ìŠµë‹ˆë‹¤.");
                                location.href = "/requestedApply";
                            }
                        });
                    });
                });
            </script>
        </div><!-- Modal end -->
</html>